function locationToggled(){var e={};document.querySelectorAll(".wpl-gmb-location-tag input").forEach(function(t){e[t.id]={share_to_location:t.checked?1:0}}),jQuery.post(ajaxurl,{action:"impress_gmb_update_location_settings",nonce:wp_listings_adminL10n["nonce-gmb-update-location-settings"],locations:e},function(e){"success"!==e&&window.location.reload()})}function clearLastPostStatus(e){e.preventDefault();var t=confirm("Clear last post status?");t&&jQuery.post(ajaxurl,{action:"wpl_clear_last_post_status",nonce:wp_listings_adminL10n["nonce-gmb-clear-last-post-status"]},function(e){window.location.reload()})}function impressListingsDataCollectionOptOut(){jQuery.post(ajaxurl,{action:"impress_listings_data_optout",nonce:wp_listings_adminL10n["nonce-impress-listings-data-optout"],optout:document.querySelector("#impress-data-optout-checkbox").checked},function(e){"success"!==e&&console.error(e)})}jQuery(document).ready(function(e){e(".notice.is-dismissible").on("click",".notice-dismiss",function(t){t.preventDefault();var i=e(this);i.parent().data("key")&&e.post(wp_listings_adminL10n.ajaxurl,{action:"wp_listings_admin_notice",url:wp_listings_adminL10n.ajaxurl,nag:i.parent().data("key"),nonce:wp_listings_adminL10n.nonce||""})}),e(".notice.is-dismissible").each(function(){if(!wp_listings_adminL10n.wp_version){var t=e(this),i=e('<button type="button" class="notice-dismiss"><span class="screen-reader-text"></span></button>'),n=wp_listings_adminL10n.dismiss||"";i.find(".screen-reader-text").text(n),t.append(i),i.on("click.wp-dismiss-notice",function(i){i.preventDefault(),t.fadeTo(100,0,function(){e(this).slideUp(100,function(){e(this).remove()})})})}}),e(".wpl-term-image-url").attr("src")?e(".wpl-term-image-url").show():e(".wpl-term-image-url").hide(),e("input#wpl-term-image").val()?(e(".wpl-add-media-text").hide(),e(".wpl-remove-media, .wpl-term-image-url").show()):(e(".wpl-add-media-text").show(),e(".wpl-remove-media, .wpl-term-image-url").hide()),e(".wpl-remove-media").click(function(t){t.preventDefault(),e("#wpl-term-image").val(""),e(".wpl-add-media-text").show(),e(".wpl-remove-media, .wpl-term-image-url, .wpl-errors").hide()});var t;e(".wpl-add-media").click(function(i){return i.preventDefault(),t?void t.open():(t=wp.media.frames.wpl_term_image_frame=wp.media({className:"media-frame",frame:"select",multiple:!1,title:wpl_term_image.title,library:{type:"image"},button:{text:wpl_term_image.button}}),t.on("select",function(){var i=t.state().get("selection").toJSON();if(i[0].sizes.wpl_term_image){i[0].sizes.wpl_term_image.url,i[0].sizes.wpl_term_image.width,i[0].sizes.wpl_term_image.height}else{i[0].sizes.full.url,i[0].sizes.full.width,i[0].sizes.full.height}var n="";wpl_term_image.min_width>i[0].sizes.full.width&&wpl_term_image.min_height>wpl_media_height?n=wpl_term_image.min_width_height_error:wpl_term_image.max_width<wpl_media_width&&wpl_term_image.max_height<wpl_media_height?n=wpl_term_image.max_width_height_error:wpl_term_image.min_width>i[0].sizes.full.width?n=wpl_term_image.min_width_error:wpl_term_image.min_height>wpl_media_height?n=wpl_term_image.min_height_error:wpl_term_image.max_width<wpl_media_width?n=wpl_term_image.max_width_error:wpl_term_image.max_height<wpl_media_height&&(n=wpl_term_image.max_height_error),n?(e(".wpl-errors p").text(n),e(".wpl-errors").show()):e(".wpl-errors").hide(),e("#wpl-term-image").val(i[0].id),e(".wpl-term-image-url").attr("src",wpl_media_url),e(".wpl-add-media-text").hide(),e(".wpl-term-image-url, .wpl-remove-media").show()}),void t.open())}),jQuery(document).on("click",".submit-imports-button",function(e){e.preventDefault();for(var t=jQuery(".selected").not(".imported").contents(),i=[],n=0;n<t.length;n++)t[n].id&&i.push(t[n].id);var a=i.join(",");jQuery.ajax({type:"get",dataType:"json",url:idxImportListingObj.url+a,data:{listings:a},beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",idxImportListingObj.nonce)},success:function(e){window.location.reload()},error:function(e){console.error(e)}})}),jQuery(document).on("click","#wpl-gmb-clear-settings-button",function(e){e.preventDefault();var t=confirm("Logout of Google My Business?");t&&jQuery.get(ajaxurl,{action:"impress_gmb_logout",nonce:wp_listings_adminL10n["nonce-gmb-logout"]},function(e){window.location.reload()})}),jQuery(document).on("click","#wpl-reset-next-post-time-button",function(e){e.preventDefault();var t=confirm("Reset next scheduled post time to 12 hours from now?");if(t){var i=jQuery("#wpl-gmb-next-post-label").text();jQuery("#wpl-gmb-next-post-label").html('<span class="dashicons dashicons-update wpl-dashicon"></span>').fadeIn("fast"),jQuery.get(ajaxurl,{action:"wpl_reset_next_post_time_request",nonce:wp_listings_adminL10n["nonce-gmb-reset-post-time"]},function(e){e?jQuery("#wpl-gmb-next-post-label").text(e):jQuery("#wpl-gmb-next-post-label").text(i)})}})});